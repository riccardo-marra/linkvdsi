# sudo apt install gdb gdbserver
# pip3 install pwn

from pwn import *

################## addresses #########################

#context.log_level = 'DEBUG'

#context.terminal = ['tmux', 'splitw', '-h']

# p = process("./vuln")
# gdb.attach(p, '''
# b main
# ''')
#     rsi - rdx - rcx - r8 - r9 - stack[0]
ARG = "%6$lx - %lx - %lx - %lx - %lx - %lx - %lx - %lx - %lx"
#ARG = "%lx - %lx - %lx - %lx - %lx - %lx - %lx - %lx - %lx"

p = gdb.debug(['./vuln', ARG], f'''
b main
# b *(main+59)

# debug automatically breaks at _start - ignore it
continue
''')

p.interactive()